<!DOCTYPE html>
<html>

<head>
    <title>socket</title>
    <meta charset="UTF-8">
    <style>
        #g {
            border: 1px solid black;
            height: 800px;
            width: 800px;
        }

    </style>
    <script src="https://unpkg.com/deeplearn"></script>
</head>

<body>
</body>
<script>
    'use strict'
    var dl = deeplearn;
    var math = new dl.NDArrayMathCPU();
    
    
    
    
    //concat1D
    var m1 = dl.Array1D.new([11,12,13]);
    var m2 = dl.Array1D.new([21,22,23]);
    var m3 = math.concat1D(m1,m2);
    document.write("result of concat1D(m1,m2) is "+m3.shape+":"+m3.getValues()+"<br>");
    //concat2D
    var m1 = dl.Array2D.new([2,2],[1,2,3,4]);
    var m2 = dl.Array2D.new([2,2],[5,6,7,8]);
    var m3 = math.concat2D(m1,m2,0);
    document.write("result of concat2D(m1,m2,0) is "+m3.shape+":"+m3.getValues()+"<br>");//4,2:1,2,3,4,5,6,7,8
    var m4 = math.concat2D(m1,m2,1);
    document.write("result of concat2D(m1,m2,1) is "+m4.shape+":"+m4.getValues()+"<br>");//2,4:1,2,5,6,3,4,7,8
    //concat3D
    var m1 = dl.Array3D.new([2,2,2],[1,5,2,6,3,7,4,8]);
    var m2 = dl.Array3D.new([2,2,2],[9,13,10,14,11,15,12,16]);
    var m3 = math.concat3D(m1,m2,0);
    document.write("result of concat3D(m1,m2,0) is "+m3.shape+":"+m3.getValues()+"<br>"); //4,2,2:1,5,2,6,3,7,4,8,9,13,10,14,11,15,12,16
    var m4 = math.concat3D(m1,m2,1);
    document.write("result of concat3D(m1,m2,1) is "+m4.shape+":"+m4.getValues()+"<br>"); //2,4,2:1,5,2,6,9,13,10,14,3,7,4,8,11,15,12,16
    var m5 = math.concat3D(m1,m2,2);
    document.write("result of concat3D(m1,m2,2) is "+m5.shape+":"+m5.getValues()+"<br>"); //2,2,4:1,5,9,13,2,6,10,14,3,7,11,15,4,8,12,16
    //concat4D
    var m1 = dl.Array4D.new([2,2,2,2],[1,9,5,13,2,10,6,14,3,11,7,15,4,12,8,16]);
    var m2 = dl.Array4D.new([2,2,2,2],[17,25,21,29,18,26,22,30,19,27,23,31,20,28,24,32]);
    var m3 = math.concat4D(m1,m2,0);
    document.write("result of concat4D(m1,m2,0) is "+m3.shape+":"+m3.getValues()+"<br>"); //4,2,2,2:1,9,5,13,2,10,6,14,3,11,7,15,4,12,8,16,17,25,21,29,18,26,22,30,19,27,23,31,20,28,24,32
    var m4 = math.concat4D(m1,m2,1);
    document.write("result of concat4D(m1,m2,1) is "+m4.shape+":"+m4.getValues()+"<br>"); //2,4,2,2:1,9,5,13,2,10,6,14,17,25,21,29,18,26,22,30,3,11,7,15,4,12,8,16,19,27,23,31,20,28,24,32
    var m5 = math.concat4D(m1,m2,2);
    document.write("result of concat4D(m1,m2,2) is "+m5.shape+":"+m5.getValues()+"<br>"); //2,2,4,2:1,9,5,13,17,25,21,29,2,10,6,14,18,26,22,30,3,11,7,15,19,27,23,31,4,12,8,16,20,28,24,32
    var m6 = math.concat4D(m1,m2,3);
    document.write("result of concat4D(m1,m2,3) is "+m6.shape+":"+m6.getValues()+"<br>"); //2,2,2,4:1,9,17,25,5,13,21,29,2,10,18,26,6,14,22,30,3,11,19,27,7,15,23,31,4,12,20,28,8,16,24,32
    
    
    document.write("EXAMPLE"+"<br>");
    
    var data1 = dl.Array3D.new([3,3,1],[1,2,3,4,5,6,7,8,9]);
    var data2 = dl.Array3D.new([3,3,1],[10,11,12,13,14,15,16,17,18]);
    var data = math.concat3D(data1,data2,2); 
    document.write("result of concat3D(data1,data2,2) is "+data.shape+":"+data.getValues()+"<br>"); //3,3,2:1,10,2,11,3,12,4,13,5,14,6,15,7,16,8,17,9,18
    
    var f1 = dl.Array4D.new([2,2,1,1],[0,0,0,1]);
    var f2 = dl.Array4D.new([2,2,1,1],[0,0,1,0]);
    var f3 = dl.Array4D.new([2,2,1,1],[0,1,0,0]);
    var f4 = dl.Array4D.new([2,2,1,1],[1,0,0,0]);
    var f5 = dl.Array4D.new([2,2,1,1],[0,0,1,1]);
    var f6 = dl.Array4D.new([2,2,1,1],[0,1,0,1]);
    
    var f11 = math.concat4D(f1,f2,2);//深度轴拼接
    document.write("result of concat4D(f1,f2,2) is "+f11.shape+":"+f11.getValues()+"<br>");//2,2,2,1:0,0,0,0,0,1,1,0
    var f22 = math.concat4D(f3,f4,2);//深度轴拼接
    document.write("result of concat4D(f3,f4,2) is "+f22.shape+":"+f22.getValues()+"<br>");//2,2,2,1:0,1,1,0,0,0,0,0
    var f33 = math.concat4D(f5,f6,2);//深度轴拼接
    document.write("result of concat4D(f5,f6,2) is "+f33.shape+":"+f33.getValues()+"<br>");//2,2,2,1:0,0,0,1,1,0,1,1
    //以上得到3个深度为2的四维矩阵，将这三个深度为2的四维矩阵拼为一组即为我们需要的卷积核
    var f111 = math.concat4D(f11,f22,3);
    document.write("result of concat4D(f11,f22,3) is "+f111.shape+":"+f111.getValues()+"<br>"); //2,2,2,2:0,0,0,1,0,1,0,0,0,0,1,0,1,0,0,0
    var f = math.concat4D(f111,f33,3);
    document.write("result of concat4D(f111,f33,3) is "+f.shape+":"+f.getValues()+"<br>"); //2,2,2,3:0,0,0,0,1,0,0,1,0,0,0,1,0,0,1,1,0,0,1,0,1,0,0,1
    
    var bias = dl.Array1D.new([0,1,0]);
    
    var output = math.conv2d(data,f,bias,[1,1],"valid");
    document.write("result of conv2d(data,f,bias,[1,1],'valid') is "+output.shape+":"+output.getValues()+"<br>"); //2,2,3:18,13,34,20,15,38,24,19,46,26,21,50
    
    var outputpooling = math.maxPool(output,[2,2],[1,1],"valid");
    document.write("result of maxPool(output,[2,2],[1,1],'valid') is "+outputpooling.shape+":"+outputpooling.getValues()+"<br>");//1,1,3:26,21,50
    


    
</script>

</html>
